**Table R1: Performance of Different Quantization Methods on MoE LLMs across two  Challenging Multi-step Reasoning Tasks (HumanEval and GSM8k).** "Gain" means the improvement of the current method compared to the previous method. 

| MODEL                 |   METHOD    | HuamnEval |   GSM8K   | AVG Accuracy  |  Gain  |
| --------------------- | :---------: | :-------: | :-------: | :-------: | :----: |
| QWEN-MoE-14b-CHAT     |     FP      |   21.34   |   30.71   |   26.03   |   -    |
|                       |     RTN     |   7.32    |   9.70    |   8.51    |   -    |
|                       | Quarot+GPTQ |   15.24   |   26.08   |   20.66   |   -    |
|                       | MoEQuant++  | **21.95** | **29.11** | **25.53** | 23.57% |
| DEEPSEEK-MoE-16b-CHAT |     FP      |   24.39   |   54.28   |   39.34   |   -    |
|                       |     RTN     |   10.41   |   28.88   |   19.65   |   -    |
|                       | Quarot+GPTQ |   13.41   |   47.08   |   30.25   |   -    |
|                       | MoEQuant++  | **21.95** | **48.97** | **35.46** | 17.22% |
| QWEN-MoE-14b          |     FP      |   32.32   |   62.55   |   47.44   |   -    |
|                       |     RTN     |   14.63   |   16.07   |   15.35   |   -    |
|                       | Quarot+GPTQ |   28.05   |   56.25   |   42.15   |   -    |
|                       | MoEQuant++  | **29.87** | **58.38** | **44.13** | 4.69%  |
| DEEPSEEK-MoE-16b      |     FP      |   26.83   |   20.16   |   23.50   |   -    |
|                       |     RTN     |   18.90   |   10.54   |   14.72   |   -    |
|                       | Quarot+GPTQ |   22.56   |   19.18   |   20.87   |   -    |
|                       | MoEQuant++  | **25.00** | **19.18** | **22.09** | 5.85%  |
| MIXTRAL-8x7B          |     FP      |   32.93   |   65.88   |   49.41   |   -    |
|                       |     RTN     |   28.05   |   27.90   |   27.98   |   -    |
|                       | Quarot+GPTQ |   27.60   |   57.92   |   42.76   |   -    |
|                       | MoEQuant++  | **32.15** | **61.79** | **46.97** | 9.84%  |


---

**Table R2: Quantitative Evaluation of Post-Training Quantization Methods on DeepSeekV2 for MMLU, GSM8K, and HumanEval Tasks.** AVG denotes the mean accuracy across the three tasks.

|    Method     | GSM8K | HumanEval | MMLU | AVG  |
| :-----------: | :---: | :-------: | :--: | ---- |
|      FP       | 41.2  |   29.9    | 58.1 | 43.1 |
|     GPTQ      | 32.2  |   23.4    | 52.7 | 36.1 |
| QuaRot + GPTQ | 37.7  |   27.9    | 54.3 | 40.0 |
|   MoEQuant    | 39.3  |   29.5    | 55.5 | **41.5** |

---

**Table R3: Time Cost Analysis of GPTQ vs. MoEQuant for MoE LLM Quantization.** For MoEQuant, it generates 128 sequences of 512 length, in order to make full use of the computing power to improve efficiency, we stitch multiple sequences together in the batch dimension. All experiments are completed on a single card A800.

| Model            | Method   | Time Cost |
| ---------------- | -------- | --------- |
| Qwen-MoE-14B     | GPTQ     |   37 mins  |
|                  | MoEQuant |   54 mins  |
| DeepSeek-MoE-16B | GPTQ     |   41 mins  |
|                  | MoEQuant |   52 mins  | 
| Mixtral-8x7B     | GPTQ     |   73 mins  |
|                  | MoEQuant |   105 mins  |

---

**Table R4: A snapshot of genrated samples by Qwen-MoE-14B, DeepSeek-MoE-16B and Mixtral 8x7B.**
| Model| Generated Sentences|
|---|---|
| Qwen-MoE-14B| ! ### GMAT Club Daily Prep\n\n#### Thank you for using the timer - this advanced tool can estimate your performance and suggest more practice questions. We have subscribed you to Daily Prep Questions via email.\n\nCustomized\nfor You\n\nwe will pick new questions that match your level based on your Timer History\n\nTrack\n\nevery week, we’ll send you an estimated GMAT score based on your performance\n\nPractice\nPays\n\nwe will pick new questions that match your level based on your Timer History......
| | 在专用电话系统中，当所拨号码发生各种类型的错误时，会受到拦截处理，此时目标会告诉系统如何进行后续处理，拦截处理有____。\nA. 直接接通\nB. 起呼\nC. 错误处理\nD. 不去电"\n答案:\nABCD
| | Generated by Django 4.1.7 on 2023-03-02 15:18\n\nfrom django.db import migrations, models\nimport django.db.models.deletion\n\n\nclass Migration(migrations.Migration):\n\n......
| | 100_{10} in base b has exactly 5 digits. What is the value of $b$? ```python\nfrom sympy import symbols, solve, Eq\n\n# Define the variable b\nb = symbols('b', integer=True)\n\n# Define the inequalities for the base b\n......
| | ______ is the first month of a year．____\nA. January\nB. February\nC. December\n答案: A．
|Deepseek-MoE-16B | \n12月31日 22:00 – 1月1日 00:30\n1月1日 00:30 – 1月1日 02:00\n1月1日 02:00 – 1月1日 03:30\n1月1日 03:30 – 1月1日 05:00\n1月1日 05:00 – 1月1日 06:30\n1月1日 06:30 – 1月1日 08:00\n1月1日 08:00 – 1月1日 09:30\n......
| | "\n    android:layout_width="match_parent"\n    android:layout_height="match_parent"\n    android:fitsSystemWindows="true"\n    tools:context=".MainActivity">\n\n    <com.google.android.material.appbar.AppBarLayout\n......     
| | #include <string>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nint solution(int n, vector<int> lost, vector<int> reserve) {\n    int answer = 0;\n    vector<int> student(n+1, 1);\n\n    for(int i=0; i<reserve.size(); i++) {\n        student[reserve[i]] = 1;\n    }\n\n    for(int i=0; i<lost.size(); i++) {\n        student[lost[i]]--;\n    }\n\n    for(int i=1; i<=n; i++) {\n        if(student[i] == 0) {\n            if(i-1 > 0 && student[i-1] == 2) {\n                student[i-1] = 1;\n                student[i]--;\n            }\n            else if(i+1 <= n && student[i+1] == 2) {\n                student[i+1] = 1;\n                student[i]--;\n            }\n        }\n    }\n\n    for(int i=1; i<=n; i++) {\n        if(student[i] > 0) {\n            answer++;\n        }\n    }\n\n    return answer;\n}\n\nint main() {\n    int n = 5;\n    vector<int> lost = {2, 4};\n    vector<int> reserve = {1, 3, 5};\n    cout << solution(n, lost, reserve) << endl;\n\n    return 0;\n}\n\n// 출력 결과: 5\n// 설명: 첫 번째 학생부터 순서대로 빌려준 학생이 있으면 빌려준다. 빌려준 학생이 없으면 자신의 옷장에서 자신의 옷을 빌려준다. 빌려준 학생이 여러 명이면 무작위로 빌려준다......
| | 而1998年为1.2%，2000年为1.5%，2001年为1.6%，2002年为1.8%，2003年为2.0%，2004年为2.2%，2005年为2.4%，2006年为2.6%，2007年为2.8%，2008年为3.0%，2009年为3.2%，2010年为3.4%，2011年为3.6%，2012年为3.8%，2013年为4.0%，2014年为4.2%，2015年为4.4%，2016年为4.6%，2017年为4.8%，2018年为5.0%，2019年为5.2%，2020年为5.4%，2021年为5.6%，2022年为5.8%......
| | he said. “We’ve got a lot of work ahead of us, but I’m confident we’ll get there.”\nIn the meantime, he said, “We’ll continue to work with our partners in the industry to ensure that we’re doing everything we can to support them.”\nThe company is also working on a number of other initiatives to support the industry, including a new program to help small and medium-sized businesses access the capital they need to grow......
| Mixtral-8x7B| Question: Calculate the greatest common divisor of 100 and 200.\nAnswer: 100
| | particularly, #11, #12, #13, #14, #15, #16, #17, #18, #19, #20, #21, #22, #23, #24, #25, #26, #27, #28, #29, #30, #31, #32, #33, #34, #35, #36, #37, #38, #39, #40, #41, #42, #43, #44......
| | #include <stdio.h>\n #include <stdlib.h>\n #include <string.h>\n #include <sys/types.h>\n #include <sys/socket.h>\n #include <netinet/in.h>\n #include <arpa/inet.h>\n #include <unistd.h>\n #include <fcntl.h>\n #include <sys/stat.h>\n #include <sys/time.h>\n #include <sys/resource.h>\n #include <sys/wait.h>\n\n #define PORT 12345\n......
| | 001\n\n## Answer (2)\n\nThe answer is yes, but it\'s a bit more complicated than that.\n\nThe reason is that there\'s no single "right" answer to this question. Instead, the answer depends on the specific context in which the question is being asked.\n\nFor example, if the question is being asked in the context of a scientific research study, then the answer will depend on the specific details of the study, such as the research question being addressed, the study design, the sample size, the data collection methods, and the statistical analysis plan......
| | Question: Let u(q) = -q**3 + 10*q**2 - 10*q + 12. Let k be u(9). Suppose -k*g + 2*g = -12. Solve -g*l + 2*l = 0 for l.\nAnswer: 0


---

**Table R5: Impact of Calibration Datasets on Expert Balance and Quantization Performance in MoE LLMs.** The expert balance std denotes the standard deviation on frequency of expert.

| Model | Calib Dataset | Expert Balance STD  | WIKITEXT2 | MMLU | HUMANEVAL | GSM8K | BOOLQ| HELLASWAG | OPENBOOKQA | MATHQA |  AVG Accuracy | 
| :--------------: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| DeepSeek-MoE-16B | Float |   \    | 6.51 | 44.60 | 26.83 | 20.16 | 72.72|58.06|32.20|31.49|40.86|
|                  | RTN   |   \    | 7.47 | 36.10 | 18.90 | 10.54 |70.21|55.76|30.60|28.87|35.85|
|                  | wikitext2 | 0.0427 | 6.67 | 40.60 | 22.56 | 19.18 | 72.17|57.03|30.60|30.95|39.01|
|                  | humaneval | 0.0877 | 6.85 | 43.60 | 21.34 | 15.39 | 73.79|56.91|30.80|30.48|38.90|
|                  | gsm8k     | 0.0928 | 6.88 | 42.40 | 21.65 | 16.59 | 73.57|57.01|30.20|30.72|38.88|
|                  | EBSS      | 0.0052 | 6.77 | 44.00 | 23.78 | 18.19 | 73.24|57.21|31.80|30.92|**39.87**|


